#!/usr/bin/env bash
# Display active IPv4s using ifconfig + grep -oP, preserving order (no sort)

set -euo pipefail

# Find ifconfig (jails often miss /sbin in PATH)
IFCONFIG_BIN="$(command -v ifconfig 2>/dev/null || true)"
[ -z "$IFCONFIG_BIN" ] && [ -x /sbin/ifconfig ] && IFCONFIG_BIN="/sbin/ifconfig"
[ -z "$IFCONFIG_BIN" ] && [ -x /usr/sbin/ifconfig ] && IFCONFIG_BIN="/usr/sbin/ifconfig"
[ -n "$IFCONFIG_BIN" ] || { echo "ifconfig command not found" >&2; exit 1; }

# Use the same PCRE the checker uses to extract IPv4 after "inet "
# Then dedupe while keeping the original order
"$IFCONFIG_BIN" \
  | grep -oP '(?<=inet\s)\d+(\.\d+){3}' \
  | awk '!seen[$0]++'
