#!/usr/bin/env bash
# Print active IPv4 addresses (one per line) using ifconfig only

set -euo pipefail

# Find ifconfig in common locations (jail PATHs often miss /sbin)
IFCONFIG_BIN=""
cand="$(command -v ifconfig 2>/dev/null || true)"
for p in "$cand" /sbin/ifconfig /usr/sbin/ifconfig /bin/ifconfig; do
  if [ -n "${p:-}" ] && [ -x "$p" ]; then
    IFCONFIG_BIN="$p"
    break
  fi
done
[ -n "$IFCONFIG_BIN" ] || { echo "ifconfig command not found" >&2; exit 1; }

# Support both net-tools formats:
#   "inet 10.0.2.15"  -> awk prints $2
#   "inet addr:10.0.2.15" -> awk prints $2 then sed strips 'addr:'
"$IFCONFIG_BIN" -a 2>/dev/null \
  | grep -oE 'inet( addr:)?([0-9]{1,3}\.){3}[0-9]{1,3}' \
  | awk '{print $2}' \
  | sed 's/^addr://; s/^ *//' \
  | sort -u
